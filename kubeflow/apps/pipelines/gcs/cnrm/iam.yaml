apiVersion: storage.cnrm.cloud.google.com/v1beta1
kind: StorageBucketAccessControl
metadata:
  name: kubeflow-test-kfp-gcs-acl # kpt-set: ${name}-kfp-gcs-acl
spec:
  bucketRef:
    name: kfmlops-kfp # kpt-set: ${bucket-name}
  entity: user-kubeflow-test-user@kfmlops.iam.gserviceaccount.com # kpt-set: user-${name}-user@${gcloud.core.project}.iam.gserviceaccount.com
  role: OWNER
---
apiVersion: iam.cnrm.cloud.google.com/v1beta1
kind: IAMPolicyMember
metadata:
  name: kubeflow-test-kfp-gcs-wi-user # kpt-set: ${name}-kfp-gcs-wi-user
spec:
  member: serviceAccount:kfmlops.svc.id.goog[kubeflow/kubeflow-pipelines-minio-gcs-gateway] # kpt-set: serviceAccount:${gcloud.core.project}.svc.id.goog[kubeflow/kubeflow-pipelines-minio-gcs-gateway]
  role: roles/iam.workloadIdentityUser
  resourceRef:
    apiVersion: iam.cnrm.cloud.google.com/v1beta1
    kind: IAMServiceAccount
    name: kubeflow-test-user # kpt-set: ${name}-user
